<app-student-navbar></app-student-navbar>

<div class="container mt-4">
  <h3 class="mb-4">Lessons</h3>

  <!-- Loading spinner -->
  <div *ngIf="isLoading" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Error message -->
  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <!-- Lessons list -->
  <div *ngIf="!isLoading && lessons.length > 0; else noLessons">
    <div *ngFor="let lesson of lessons" class="card mb-3 p-3">
      <h5>Lesson {{ lesson.lesson_number }}: {{ lesson.title }}</h5>
      <p>{{ lesson.content }}</p>

      <div *ngIf="lesson.video_url">
        <p><strong>Video:</strong></p>
        <a [href]="lesson.video_url" target="_blank" class="btn btn-sm btn-outline-info">Watch Video</a>
      </div>

      <div *ngIf="lesson.pdf_file">
        <p><strong>PDF:</strong></p>
        <a [href]="lesson.pdf_file" target="_blank" class="btn btn-sm btn-outline-secondary">View PDF</a>
      </div>

      <div class="mt-3">
        <button
          class="btn"
          [ngClass]="lesson.completed ? 'btn-success' : 'btn-outline-success'"
          [disabled]="lesson.completed"
          (click)="markAsCompleted(lesson.id)">
          {{ lesson.completed ? 'Completed' : 'Mark as Completed' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Fallback if no lessons -->
  <ng-template #noLessons>
    <p>No lessons available for this course.</p>
  </ng-template>
</div>
